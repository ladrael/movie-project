<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<!-- 주의! mapper 태그 내의 namespace 속성에 현재 XML 파일과 연결될 자바 클래스를 명시해야한다! -->
<mapper namespace="com.itwillbs.movie.mapper.MyBatisMapper">
	
	<!-- 회원가입 -->
<!-- 	<insert id="insertMember"> -->
<!-- 		INSERT INTO member -->
<!-- 			VALUES( -->
<!-- 				   #{member_id} -->
<!-- 				   , #{member_name} -->
<!-- 				   , #{member_pw} -->
<!-- 				   , #{member_bday} -->
<!-- 				   , #{member_email} -->
<!-- 				   , #{member_tel} -->
<!-- 				   , '1000' -->
<!-- 				   , #{member_prefer_branch} -->
<!-- 				   , #{member_prefer_genre} -->
<!-- 				   , now() -->
<!-- 			) -->
<!-- 	</insert> -->

	<!-- 회원가입 수정-->
	<insert id="insertMember">
		INSERT INTO member
			VALUES(
				   #{member_id}
				   , #{member_name}
				   , #{member_pw}
				   , #{member_bday}
				   , #{member_email}
<!-- 					CONCAT(#{email1}, '@', #{email2}),  -->
				   , #{member_tel}
				   , '1000'
				   , #{member_prefer_branch}
				   , #{member_prefer_genre}
				   , now()
			)
	</insert>
	
	<!-- 로그인 조회 -->
<!-- 	<select id="chekUser" resultType="hashmap"> -->
<!-- 		SELECT *  -->
<!-- 			FROM member -->
<!-- 				WHERE member_id = #{member_id} AND member_pw = #{member_pw} -->
<!-- 	</select> -->

	<!-- 로그인 조회 -해싱 -->
	<select id="chekUser" resultType="hashmap">
		SELECT * 
			FROM member
				WHERE member_id = #{member_id} 
	</select>
	
	<!-- 카카오 회원 확 -->
	<select id="selectKakao" resultType="hashmap">
		SELECT * FROM member
			WHERE member_email = #{email}
	</select>
	
	<select id="selectMemberId" resultType="hashmap">
		SELECT * 
				FROM member
					WHERE member_id = #{id}
	</select>
	
	<select id="selectItem" resultType="hashmap">
		SELECT * 
			FROM item
	</select>
	
	<delete id="deleteItem">
		DELETE FROM item
			 WHERE item_code = #{item_code}
	</delete>
	
	<select id="selectGift" resultType="hashmap">
		SELECT * FROM item
			WHERE item_type = 'giftcard'
	</select>
	
	<select id="selectFood" resultType="hashmap">
		SELECT * FROM item
			WHERE item_type = 'food'
	</select>
	
	<select id="selectTicket" resultType="hashmap">
		SELECT * FROM item
			WHERE item_type = 'ticket'
	</select>
	
	<select id="selectCode" resultType="hashmap">
		SELECT * FROM item
			WHERE item_code = #{item_code}
	</select>
	
	<!-- 관리자 상품 등록 -->
	<insert id="registItem">
		INSERT INTO item
			VALUES(
				   #{item_code}
				   , #{item_type}
				   , #{item_name}
				   , #{item_price}
				   , #{item_detail}
				   , #{item_image}
				   , #{item_status}
			)
	</insert>
	
	<!-- 관리자 상품 수정 -->
	<update id="updateItem">
		UPDATE item 
			SET item_type = #{item_type}
			  , item_price = #{item_price}
			  , item_name = #{item_name}
			  , item_price = #{item_price}
			  , item_detail = #{item_detail}
			  , item_image = #{item_image}
			  , item_status = #{item_status}
					WHERE item_code = #{item_code}
	</update>
	
	
	<!-- 스토어 결제 저장-->
	<insert id="insertPay">
		INSERT INTO pay
			VALUES(
				   #{pay_code}
				 , #{id}
				 , #{item_code}
				 , #{pay_type}
				 , #{pay_price}
				 , DATE_FORMAT('20200405','%Y-%m-%d')
				 , 'N'
				 , #{pay_status}
			)
	</insert>
	
	<!-- 결제 조회 -->
	<select id="selectPay" resultType="hashmap">
		SELECT * FROM pay
	</select>
	
	<!-- 결제 내역 삭제 -->
	<delete id="payDelete">
		DELETE FROM pay
			WHERE pay_code = #{pay_code}
	</delete>
	
	<!-- 결제 조회(pay_code) -->
	<select id="selectPayUpdate" resultType="hashmap">
		SELECT * FROM pay
			WHERE pay_code = #{pay_code}
	</select>
	
	<!-- 결제 수정 -->
	<update id="payUpdate">
		UPDATE pay
			SET pay_code = #{pay_code}
			  , member_id = #{member_id}
			  , item_code = #{item_code}
			  , pay_type = #{pay_type}
			  , pay_price = #{pay_price}
			  , pay_date = #{pay_date}
			  , pay_cancel_date = #{pay_cancel_date}
			  , pay_status = #{pay_status}
			 	WHERE pay_code = #{pay_code}
	</update>
	
	
	<!-- 포인트 적립 -->
	<update id="updatePoint">
		UPDATE member
			SET member_point = #{point}
				WHERE member_id = #{id}
	</update>
	
	<!-- 멤버리스트 -->
	<select id="selectMember" resultType="hashmap">
		SELECT * FROM member
	</select>

	<!-- 메인페이지 핫상품3개 -->
	<select id="selectHot" resultType="hashmap">
		SELECT *
		  FROM item
		 WHERE item_status = 'hot'
	</select>
</mapper>



















